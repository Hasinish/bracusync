--- connect.php ---
Path: .\connect.php

<?php
$server = 'localhost';
$username = 'root';
$password = '';
$database = 'bracusync';
$conn = new mysqli('localhost', 'root', '', 'bracusync');

?>



--- index.php ---
Path: .\index.php

<?php 
session_start();
require_once 'connect.php';

if (!isset($_SESSION['user_id'])) {
    header("Location: Login/loginpage.php");
    exit();
} ?>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BracuSync — Home</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="bg-overlay"></div>
    <main>
        <header>
            <h1>BracuSync</h1>
            <p>Your portal to connect and collaborate</p>
        </header>

        <nav>
            <a href="index.php" class="active">Home</a>
            <a href="Profile_dashboard/profile.php">Profile</a>
            <a href="lost_and_found/lost_and_foundpage.php">Lost And Found</a>
            <a href="Resource_Repository/resourcepage.php">Resource Repository</a>
            <a href="logout.php">Logout</a>
        </nav>  

        <div class="container">
            <h1>Welcome, <?= ($_SESSION['username']); ?> to BracuSync!</h1>
            <p>This is a simple and secure platform for students to log in, register, and access services easily. Get started by going to your profile and editing your routine, adding courses, and find out what's happeing in your groups.</p>
            
        </div>
    </main>

    <footer class="site-footer">
        © 2025 Brac University. All rights reserved.
    </footer>
</body>
</html>

--- logout.php ---
Path: .\logout.php

<?php
session_start();
require_once 'connect.php';

$user_id = $_SESSION['user_id'];
$sql = "SELECT * FROM user WHERE user_id = $user_id";
$result = mysqli_query($conn, $sql);
$row = mysqli_fetch_assoc($result);

if ($row['status'] !== "Hidden") {
    $user_id = $_SESSION['user_id'];
    $update_status = "UPDATE user SET status = 'Offline' WHERE user_id = $user_id";
    mysqli_query($conn, $update_status);
}


session_unset();
session_destroy();

header("Location: /BracuSync/Login/loginpage.php");
exit();
?>


--- select_courses.php ---
Path: .\course_enrollment\select_courses.php

<?php
session_start();
require_once '../connect.php';

if (!isset($_SESSION['user_id'])) {
    header("Location: ../Login/loginpage.php");
    exit();
}

$user_id = $_SESSION['user_id'];


$dept_query = "SELECT DISTINCT LEFT(course_code, 3) AS department_prefix FROM sections ORDER BY department_prefix";
$dept_result = mysqli_query($conn, $dept_query);

$selected_dept = isset($_POST['department']) ? $_POST['department'] : '';
$selected_course = isset($_POST['course']) ? $_POST['course'] : '';
$selected_section = isset($_POST['section']) ? $_POST['section'] : '';

$enrolled = false;


if ($selected_dept!=="") {
    $course_query = "SELECT DISTINCT course_code FROM sections WHERE course_code LIKE '{$selected_dept}%' ORDER BY course_code";
    $course_result = mysqli_query($conn, $course_query);
}


if ($selected_course!=="") {
    $section_query = "SELECT DISTINCT section FROM sections WHERE course_code = '$selected_course' ORDER BY section";
    $section_result = mysqli_query($conn, $section_query);
}


if ($selected_course!="" and $selected_section!=="") {
    $details_query = "SELECT * FROM class_schedule cs join sections s ON s.section_id=cs.section_id WHERE course_code = '$selected_course' AND section = '$selected_section'";
    $details_result = mysqli_query($conn, $details_query);
}


if (isset($_POST['enroll']) and $selected_course!=="" and $selected_section!=="") {
    $section_id_query = "SELECT section_id FROM sections 
                         WHERE course_code = '$selected_course' 
                         AND section = '$selected_section'";
    $section_id_result = mysqli_query($conn, $section_id_query);

    $success_count = 0;
    while ($row = mysqli_fetch_assoc($section_id_result)) {
        $section_id = $row['section_id'];

        
        $enroll_query = "INSERT IGNORE INTO enrollments (section_id, user_id, enrollment_date) 
                         VALUES ($section_id, $user_id, CURDATE())";
        if (mysqli_query($conn, $enroll_query)) {
            $success_count++;
        }
    }

    if ($success_count > 0) {
        $enrolled = true;
    } else {
        $error = "You might already be enrolled in this section.";
    }
}
?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit routine</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="bg-overlay"></div>
    <main>
        <nav>
            <a href="../index.php">Home</a>
            <a href="../Profile_dashboard/profile.php">Profile</a>
            <a href="../lost_and_found/lost_and_foundpage.php">Lost And Found</a>
            <a href="../Resource_Repository/resourcepage.php">Resource Repository</a>
            <a href="../logout.php">Logout</a>
        </nav>

        <div class="container enroll-section">
            <h1>Routine Maker</h1>
            <div class="section card">
                <?php if ($enrolled): ?>
                    <p class="success">✅ Successfully added to routine: <?= htmlspecialchars($selected_course) ?> Section <?= htmlspecialchars($selected_section) ?></p>
                <?php elseif (!empty($error)): ?>
                    <p class="error">❌ <?= htmlspecialchars($error) ?></p>
                <?php endif; ?>

                <form method="POST" action="" class="report-form">
                    
                    <label for="department">Department</label>
                    <select id="department" name="department" onchange="this.form.submit()" required>
                        <option value="">-- Select Department --</option>
                        <?php while ($dept = mysqli_fetch_assoc($dept_result)): ?>
                            <option value="<?= htmlspecialchars($dept['department_prefix']) ?>" <?= $selected_dept == $dept['department_prefix'] ? 'selected' : '' ?>>
                                <?= htmlspecialchars($dept['department_prefix']) ?>
                            </option>
                        <?php endwhile; ?>
                    </select>

                    
                    <?php if ($selected_dept): ?>
                        <label for="course">Course</label>
                        <select id="course" name="course" onchange="this.form.submit()" required>
                            <option value="">-- Select Course --</option>
                            <?php while ($course = mysqli_fetch_assoc($course_result)): ?>
                                <option value="<?= htmlspecialchars($course['course_code']) ?>" <?= $selected_course == $course['course_code'] ? 'selected' : '' ?>>
                                    <?= htmlspecialchars($course['course_code']) ?>
                                </option>
                            <?php endwhile; ?>
                        </select>
                    <?php endif; ?>

                    
                    <?php if ($selected_course): ?>
                        <label for="section">Section</label>
                        <select id="section" name="section" onchange="this.form.submit()" required>
                            <option value="">-- Select Section --</option>
                            <?php while ($sec = mysqli_fetch_assoc($section_result)): ?>
                                <option value="<?= htmlspecialchars($sec['section']) ?>" <?= $selected_section == $sec['section'] ? 'selected' : '' ?>>
                                    <?= htmlspecialchars($sec['section']) ?>
                                </option>
                            <?php endwhile; ?>
                        </select>
                    <?php endif; ?>

                    
                    <?php if ($selected_course && $selected_section): ?>
                        <table class="routine-table">
                            <thead>
                                <tr>
                                    <th>Day</th>
                                    <th>Time</th>
                                    <th>Room</th>
                                    <th>Faculty</th>
                                </tr>
                            </thead>
                            <tbody>
                                <?php while ($row = mysqli_fetch_assoc($details_result)): ?>
                                    <tr>
                                        <td><?= htmlspecialchars($row['day']) ?></td>
                                        <td><?= htmlspecialchars(substr($row['start_time'], 0, 5)) ?> - <?= htmlspecialchars(substr($row['end_time'], 0, 5)) ?></td>
                                        <td><?= htmlspecialchars($row['room']) ?></td>
                                        <td><?= htmlspecialchars($row['faculty'] ?? 'N/A') ?></td>
                                    </tr>
                                <?php endwhile; ?>
                            </tbody>
                        </table>

                        <button type="submit" name="enroll" class="btn">Add to routine</button>
                    <?php endif; ?>
                </form>
                
            </div>
        </div>
    </main>

    <footer class="site-footer">
        © 2025 Brac University. All rights reserved.
    </footer>
</body>
</html>

--- group_posts.php ---
Path: .\group_post\group_posts.php

<?php
session_start();
require_once '../connect.php';


if (!isset($_SESSION['user_id'])) {
    header("Location: ../Login/loginpage.php");
    exit();
}

$user_id = $_SESSION['user_id'];
$section_id = isset($_GET['section_id']) ? intval($_GET['section_id']) : 0;


$verify_query = "SELECT 1 FROM enrollments WHERE user_id = $user_id AND section_id = $section_id";
$verify_result = mysqli_query($conn, $verify_query);
if (mysqli_num_rows($verify_result) == 0) {
    header("Location: group_select.php");
    exit();
}


$is_instructor = false;
$instructor_query = "
    SELECT 1 
    FROM instructor i 
    JOIN enrollments e ON i.user_id = e.user_id 
    WHERE e.user_id = $user_id AND e.section_id = $section_id";
$instructor_result = mysqli_query($conn, $instructor_query);
if (mysqli_num_rows($instructor_result) > 0) {
    $is_instructor = true;
}


if ($is_instructor && isset($_POST['post_content'])) {
    $content = trim($_POST['post_content']);
    if (!empty($content)) {
        $post_query = "
            INSERT INTO group_post (content, user_id, section_id, timestamp) 
            VALUES ('$content', $user_id, $section_id, CURRENT_TIMESTAMP)";
        mysqli_query($conn, $post_query);
    }
}


if (isset($_POST['comment_content']) && isset($_POST['post_id'])) {
    $content = trim($_POST['comment_content']);
    $post_id = intval($_POST['post_id']);
    if (!empty($content)) {
        $comment_query = "
            INSERT INTO comments (content, timestamp, user_id, post_id) 
            VALUES ('$content', CURRENT_TIMESTAMP, $user_id, $post_id)";
        mysqli_query($conn, $comment_query);
    }
}


$section_query = "SELECT course_code, section FROM sections WHERE section_id = $section_id";
$section_result = mysqli_query($conn, $section_query);
$section = mysqli_fetch_assoc($section_result);


$posts_query = "
    SELECT gp.post_id, gp.content, gp.timestamp, u.username
    FROM group_post gp
    JOIN user u ON gp.user_id = u.user_id
    WHERE gp.section_id = $section_id
    ORDER BY gp.timestamp DESC";
$posts_result = mysqli_query($conn, $posts_query);
?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Group Posts — BracuSync</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="bg-overlay"></div>
    <main>
        
        <nav>
            <a href="../index.php">Home</a>
            <a href="../Profile_dashboard/profile.php">Profile</a>
            <a href="../lost_and_found/lost_and_foundpage.php">Lost And Found</a>
            <a href="../Resource_Repository/resourcepage.php">Resource Repository</a>
            <a href="group_select.php" class="active">Groups</a>
            <a href="../logout.php">Logout</a>
        </nav>

        
        <div class="container posts-section">
            <h1><?= ($section['course_code']) ?> - Section <?= ($section['section']) ?> Group</h1>
            <div class="section card">
                
                <?php if ($is_instructor): ?>
                    <form action="" method="POST" class="report-form">
                        <label for="post_content">Create Announcement</label>
                        <textarea id="post_content" name="post_content" placeholder="Write your announcement..." required></textarea>
                        <button type="submit" class="btn">Post Announcement</button>
                    </form>
                <?php endif; ?>

                
                <div class="posts-feed">
                    <?php if (mysqli_num_rows($posts_result) == 0): ?>
                        <p class="no-posts">No posts available yet.</p>
                    <?php else: ?>
                        <?php while ($post = mysqli_fetch_assoc($posts_result)): ?>
                            <div class="post">
                                <div class="post-header">
                                    <span class="username"><?= ($post['username']) ?></span>
                                    <span class="timestamp"><?= ($post['timestamp']) ?></span>
                                </div>
                                <div class="post-content">
                                    <p><?= ($post['content']) ?></p>
                                </div>
                                
                                <div class="comments-section">
                                    <?php
                                    $comments_query = "
                                        SELECT c.content, c.timestamp, u.username
                                        FROM comments c
                                        JOIN user u ON c.user_id = u.user_id
                                        WHERE c.post_id = {$post['post_id']}
                                        ORDER BY c.timestamp ASC";
                                    $comments_result = mysqli_query($conn, $comments_query);
                                    while ($comment = mysqli_fetch_assoc($comments_result)):
                                    ?>
                                        <div class="comment">
                                            <div class="comment-header">
                                                <span class="username"><?= ($comment['username']) ?></span>
                                                <span class="timestamp"><?= ($comment['timestamp']) ?></span>
                                            </div>
                                            <p><?= ($comment['content']) ?></p>
                                        </div>
                                    <?php endwhile; ?>
                                    
                                    <form action="" method="POST" class="report-form comment-form">
                                        <input type="hidden" name="post_id" value="<?= $post['post_id'] ?>">
                                        <textarea name="comment_content" placeholder="Add a comment..." required></textarea>
                                        <button type="submit" class="btn">Comment</button>
                                    </form>
                                </div>
                            </div>
                        <?php endwhile; ?>
                    <?php endif; ?>
                </div>
            </div>
        </div>
    </main>

    
    <footer class="site-footer">
        © 2025 Brac University. All rights reserved.
    </footer>
</body>
</html>

--- group_select.php ---
Path: .\group_post\group_select.php

<?php
session_start();
require_once '../connect.php';


if (!isset($_SESSION['user_id'])) {
    header("Location: ../Login/loginpage.php");
    exit();
}

$user_id = $_SESSION['user_id'];


$sections_query = "
    SELECT s.section_id, s.course_code, s.section
    FROM enrollments e
    JOIN sections s ON e.section_id = s.section_id
    WHERE e.user_id = $user_id
    ORDER BY s.course_code, s.section";
$sections_result = mysqli_query($conn, $sections_query);
?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Select Group — BracuSync</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="bg-overlay"></div>
    <main>
        
        <nav>
            <a href="../index.php">Home</a>
            <a href="../Profile_dashboard/profile.php">Profile</a>
            <a href="../lost_and_found/lost_and_foundpage.php">Lost And Found</a>
            <a href="../Resource_Repository/resourcepage.php">Resource Repository</a>
            <a href="../logout.php">Logout</a>
        </nav>

        
        <div class="container report-section">
            <h1>Select Group</h1>
            <div class="section card">
                <form action="group_posts.php" method="GET" class="report-form">
                    <label for="section_id">Your Enrolled Sections</label>
                    <select id="section_id" name="section_id" required>
                        <option value="">-- Select Group --</option>
                        <?php while ($section = mysqli_fetch_assoc($sections_result)): ?>
                            <option value="<?= ($section['section_id']) ?>">
                                <?= ($section['course_code']) ?> - Section <?= ($section['section']) ?>
                            </option>
                        <?php endwhile; ?>
                    </select>
                    <button type="submit" class="btn">View Group</button>
                </form>
            </div>
        </div>
    </main>

    
    <footer class="site-footer">
        © 2025 Brac University. All rights reserved.
    </footer>
</body>
</html>

--- login.php ---
Path: .\Login\login.php

<?php
session_start();
require_once '../connect.php';

$email = $_POST['email'];
$password = $_POST['password'];

$sql = "SELECT * FROM user WHERE email = '$email'";
$result = mysqli_query($conn, $sql);

if (mysqli_num_rows($result) === 1) {
    $user = mysqli_fetch_assoc($result);

    if (password_verify($password, $user['password'])) {
        $_SESSION['username'] = $user['username'];
        $_SESSION['email'] = $user['email'];
        $_SESSION['user_id'] = $user['user_id'];
        $_SESSION['status'] = $user['status']; 

        if ($user['status'] !== 'Hidden') {
            $update_status = "UPDATE user SET status = 'Online' WHERE user_id = " . $user['user_id'];
            mysqli_query($conn, $update_status);
        }

        header("Location: ../welcome__role_select/welcome.php");
        exit();
    } else {
        $_SESSION['login_error'] = "Incorrect username or password!";
        header("Location: /BracuSync/Login/loginpage.php");
        exit();
    }
} else {
    $_SESSION['login_error'] = "Incorrect username or password!";
    header("Location: /BracuSync/Login/loginpage.php");
    exit();
}

mysqli_close($conn);
?>

--- loginpage.php ---
Path: .\Login\loginpage.php

<?php session_start(); ?>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login and Registration Form</title>
    <link rel="stylesheet" href="style.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
</head>
<body>
    <div class="video-background">
        <iframe 
            src="https://www.youtube.com/embed/tthY4pJqfEw?autoplay=1&mute=1&controls=0&showinfo=0&modestbranding=1&rel=0&loop=1&playlist=tthY4pJqfEw&playsinline=1" 
            frameborder="0" 
            allow="autoplay; fullscreen" 
            allowfullscreen>
        </iframe>
    </div>
    <div class="video-overlay"></div>

    <div class="wrapper">
        <span class="bg"></span>

        <div class="form-box login">
            <h2>Login</h2>
            <form action="login.php" method="POST">

                <div class="input-box">
                    <input type="email" name="email" placeholder=" ">
                    <label>Email</label>
                    <i class='bx bxs-envelope' style='color:#ffffff'  ></i>
                </div>

                <div class="input-box">
                    <input type="password" name="password" placeholder=" ">
                    <label>Password</label>
                    <i class='bx bxs-lock-alt'></i>
                </div>

                <button type="submit" class="btn">Login</button>

                <div class="logreg-link">
                    <p>Don't have an account? <a href="../Registration/registerpage.php" class="register-link">Sign Up</a></p>
                </div>

                <?php if (isset($_SESSION['login_error'])): ?>
                    <p style="color: red;"><?php echo $_SESSION['login_error']; ?></p>
                    <?php unset($_SESSION['login_error']); ?>
                <?php endif; ?>

            </form>
        </div>
        <div class="info-text login">
            <h2>Welcome back!</h2>
            <p>Login to your existing account or sign up now!</p>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>


--- delete.php ---
Path: .\lost_and_found\delete.php

<?php
session_start();
require_once '../connect.php';

if (isset($_GET['id'], $_SESSION['user_id'])) {
    $id = intval($_GET['id']);
    $user_id = $_SESSION['user_id'];
    
    $sql = "SELECT * FROM lost_and_found WHERE item_id = $id AND user_id = $user_id";
    $result = $conn->query($sql);
    if ($result->num_rows === 1) {
        
        if ($conn->query("DELETE FROM lost_and_found WHERE item_id = $id")) {
            header("Location: lost_and_foundpage.php");
            exit();
        } else {
            echo "Error deleting report.";
        }
    }
}

$conn->close();
?>

--- lost_and_foundpage.php ---
Path: .\lost_and_found\lost_and_foundpage.php

<?php 
session_start();
require_once '../connect.php';

if (!isset($_SESSION['user_id'])) {
    header("Location: ../Login/loginpage.php");
    exit();
}
?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lost and Found — BracuSync</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="bg-overlay"></div>
    <main>
        

        <nav>
            <a href="../index.php">Home</a>
            <a href="../Profile_dashboard/profile.php">Profile</a>
            <a href="lost_and_foundpage.php" class="active">Lost And Found</a>
            <a href="../Resource_Repository/resourcepage.php">Resource Repository</a>
            <a href="../logout.php">Logout</a>
        </nav>

        <div class="container report-section">
            <h1>Report Lost Item</h1>
            <div class="section card">
                <form action="upload.php" method="post" enctype="multipart/form-data" class="report-form">
                    <label for="item_name">Item Name</label>
                    <input type="text" id="item_name" name="item_name" required>

                    <label for="description">Description</label>
                    <textarea id="description" rows="4" name="description" required></textarea>

                    <label for="location_found">Location Found</label>
                    <input type="text" id="location_found" name="location_found" required>

                    <label for="date">Date</label>
                    <input type="date" id="date" name="date" required>

                    <label for="time">Time</label>
                    <input type="time" id="time" name="time" required>

                    <label for="item_image">Upload Picture</label>
                    <input type="file" id="item_image" name="item_image" accept="image/*">

                    <button type="submit" class="btn">Submit Report</button>
                </form>
            </div>
        </div>

        <div class="container items-section">
            <h1>Recently Reported Items</h1>
            <div class="section card">
                <table class="routine-table">
                    <thead>
                        <tr>
                            <th>Item Name</th>
                            <th>Description</th>
                            <th>Location</th>
                            <th>Date</th>
                            <th>Time</th>
                            <th>Images</th>
                            <th>Reported By</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <?php
                        $sql = "SELECT lost_and_found.*, user.username 
                                FROM lost_and_found 
                                JOIN user ON lost_and_found.user_id = user.user_id 
                                ORDER BY lost_and_found.date DESC";
                        $result = mysqli_query($conn, $sql);

                        if (mysqli_num_rows($result) > 0) {
                            while ($row = $result->fetch_assoc()) {
                                echo "<tr>
                                    <td>" . ($row['item_name']) . "</td>
                                    <td>" . ($row['description']) . "</td>
                                    <td>" . ($row['location']) . "</td> 
                                    <td>" . ($row['date']) . "</td>
                                    <td>" . ($row['time']) . "</td>
                                    <td><a href='" . ($row['image_path']) . "' target='_blank'>Show Image</a></td>
                                    <td>" . ($row['username']) . "</td>";

                                if (isset($_SESSION['user_id']) && $_SESSION['user_id'] == $row['user_id']) {
                                    echo "<td><a href='delete.php?id=" . ($row['item_id']) . "' onclick=\"return confirm('Delete this report?');\">Delete</a></td>";
                                } else {
                                    echo "<td>-</td>";
                                }

                                echo "</tr>";
                            } 
                        } else {
                            echo "<tr><td colspan='8'>No items reported yet.</td></tr>";
                        }

                        $conn->close();
                        ?>
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <footer class="site-footer">
        © 2025 Brac University. All rights reserved.
    </footer>
</body>
</html>

--- upload.php ---
Path: .\lost_and_found\upload.php

<?php

session_start(); 
require_once '../connect.php'; 


$item_name = $_POST['item_name'];
$description = $_POST['description'];
$location_found = $_POST['location_found'];
$date = $_POST['date'];
$time = $_POST['time'];
$user_id = $_SESSION['user_id'];


$image = $_FILES['item_image'];
$target_path = null;

if ($image['error'] === 0) {
    $unique_name = time() . '_' . basename($image['name']);
    $target_path = 'uploads/' . $unique_name;
    move_uploaded_file($image['tmp_name'], $target_path);
}

$sql = "INSERT INTO lost_and_found 
        (item_name, description, location, date, time, image_path, user_id)
        VALUES 
        ('$item_name', '$description', '$location_found', '$date', '$time', '$target_path', '$user_id')";
mysqli_query($conn, $sql);
header("Location: lost_and_foundpage.php");




?>




--- messages.php ---
Path: .\messaging\messages.php

<?php
session_start();
require_once '../connect.php';

if (!isset($_SESSION['user_id'])) {
    header("Location: ../Login/loginpage.php");
    exit();
}

$user_id = $_SESSION['user_id'];

$users_query = "SELECT user_id, username FROM user WHERE user_id != $user_id ORDER BY username";
$users_result = mysqli_query($conn, $users_query);


$selected_user_id = isset($_GET['user_id']) ? intval($_GET['user_id']) : 0;
$selected_username = '';
$messages = [];


if ($selected_user_id !== 0) {
    $user_check_query = "SELECT username FROM user WHERE user_id = $selected_user_id";
    $user_check_result = mysqli_query($conn, $user_check_query);
    if (mysqli_num_rows($user_check_result) > 0) {
        $selected_username = mysqli_fetch_assoc($user_check_result)['username'];
        $messages_query = "
            SELECT m.content, m.timestamp, m.sender_id, u.username
            FROM message m
            JOIN user u ON m.sender_id = u.user_id
            WHERE (m.sender_id = $user_id AND m.recever_id = $selected_user_id)
               OR (m.sender_id = $selected_user_id AND m.recever_id = $user_id)
            ORDER BY m.timestamp ASC";
        $messages_result = mysqli_query($conn, $messages_query);
        while ($row = mysqli_fetch_assoc($messages_result)) {
            $messages[] = $row;
        }
    } else {
        $selected_user_id = 0; 
    }
}

if (isset($_POST['message_content']) && $selected_user_id > 0) {
    $content = trim($_POST['message_content']);
    if (!empty($content)) {
        $message_query = "
            INSERT INTO message (sender_id, recever_id, content, timestamp)
            VALUES ($user_id, $selected_user_id, '$content', CURRENT_TIMESTAMP)";
        mysqli_query($conn, $message_query);
        
        header("Location: messages.php?user_id=$selected_user_id");
        exit();
    }
}
?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Messages — BracuSync</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="bg-overlay"></div>
    <main>
        
        <nav>
            <a href="../index.php">Home</a>
            <a href="../Profile_dashboard/profile.php">Profile</a>
            <a href="../lost_and_found/lost_and_foundpage.php">Lost And Found</a>
            <a href="../Resource_Repository/resourcepage.php">Resource Repository</a>
            <a href="../group_post/group_select.php">Groups</a>
            <a href="messages.php" class="active">Messages</a>
            <a href="../logout.php">Logout</a>
        </nav>

        
        <div class="container messaging-section">
            <h1>Messages</h1>
            <div class="messaging-container">
                
                <div class="sidebar">
                    <h2>Users</h2>
                    <ul class="user-list">
                        <?php while ($user = mysqli_fetch_assoc($users_result)): ?>
                            <li class="<?= $selected_user_id == $user['user_id'] ? 'active' : '' ?>">
                                <a href="messages.php?user_id=<?= ($user['user_id']) ?>">
                                    <?= ($user['username']) ?>
                                </a>
                            </li>
                        <?php endwhile; ?>
                    </ul>
                </div>

                
                <div class="chat-area">
                    <?php if ($selected_user_id > 0): ?>
                        <h2>Chat with <?= ($selected_username) ?></h2>
                        <div class="messages">
                            <?php if (empty($messages)): ?>
                                <p class="no-messages">No messages yet.</p>
                            <?php else: ?>
                                <?php foreach ($messages as $message): ?>
                                    <div class="message <?= $message['sender_id'] == $user_id ? 'sent' : 'received' ?>">
                                        <div class="message-header">
                                            <span class="username"><?= ($message['username']) ?></span>
                                            <span class="timestamp"><?= ($message['timestamp']) ?></span>
                                        </div>
                                        <p><?= ($message['content']) ?></p>
                                    </div>
                                <?php endforeach; ?>
                            <?php endif; ?>
                        </div>
                        
                        <form action="" method="POST" class="report-form message-form">
                            <textarea name="message_content" placeholder="Type a message..." required></textarea>
                            <button type="submit" class="btn">Send</button>
                        </form>
                    <?php else: ?>
                        <p class="no-selection">Select a user to start chatting.</p>
                    <?php endif; ?>
                </div>
            </div>
        </div>
    </main>

    
    <footer class="site-footer">
        © 2025 Brac University. All rights reserved.
    </footer>
</body>
</html>

--- edit_profile.php ---
Path: .\Profile_dashboard\edit_profile.php

<?php
session_start();
require_once '../connect.php';

if (!isset($_SESSION['user_id'])) {
    header("Location: ../Login/loginpage.php");
    exit();
}

$user_id = $_SESSION['user_id'];
$is_student = false;
$is_instructor = false;

$check__student_query = "SELECT * FROM student WHERE user_id = {$_SESSION['user_id']}";
$check__instructor_query = "SELECT * FROM instructor WHERE user_id = {$_SESSION['user_id']}";

$check_student_result = mysqli_query($conn, $check__student_query);
$check_instructor_result = mysqli_query($conn, $check__instructor_query);

if(mysqli_num_rows($check_student_result) > 0){
    $is_student = true;
}
if(mysqli_num_rows($check_instructor_result) > 0){
    $is_instructor = true;
}


if($is_student){
    $student_query = "SELECT * FROM user JOIN student ON user.user_id = student.user_id WHERE user.user_id = $user_id";
    $student_result = mysqli_query($conn, $student_query);
    $student = mysqli_fetch_assoc($student_result);
}

if($is_instructor){
    $instructor_query = "SELECT * FROM user JOIN instructor ON user.user_id = instructor.user_id WHERE user.user_id = $user_id";
    $instructor_result = mysqli_query($conn, $instructor_query);
    $instructor = mysqli_fetch_assoc($instructor_result);
    $designation = $instructor['designation'];
}


if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $username = trim($_POST['username']);
    $email = trim($_POST['email']);
    $major = trim($_POST['major']);
    $batch = trim($_POST['batch']);
    $designation = trim($_POST['designation']);
    $initial = trim($_POST['initial']);
    $department = trim($_POST['department']);
    $password = password_hash($_POST['password'], PASSWORD_DEFAULT);
    if (!empty($_POST['password'])) {
        $query1 = "UPDATE user SET username='$username', email='$email', password='$password' WHERE user_id=$user_id";
    } else {
        $query1 = "UPDATE user SET username='$username', email='$email' WHERE user_id=$user_id";
    }
    
    mysqli_query($conn, $query1);

    if ($is_student) {
        $query2 = "UPDATE student SET major='$major', batch='$batch' WHERE user_id=$user_id";
    } 
    
    if ($is_instructor) {
        $query2 = "UPDATE instructor SET designation='$designation', initial='$initial', department='$department' WHERE user_id=$user_id";
    }
    
    mysqli_query($conn, $query2);
    
    $_SESSION['username'] = $username;
    $_SESSION['email'] = $email;

    header("Location: profile.php");
    exit();
}

$query = "SELECT * FROM user WHERE user_id=$user_id";
$result = mysqli_query($conn, $query);
$user = mysqli_fetch_assoc($result);
?>

<!DOCTYPE html>
<html>
<head>
    <title>Edit Profile</title>
    <link rel="stylesheet" href="edit_profile.css">
</head>
<body>
    <div class="dashboard">
        <h1>Edit Profile</h1>
        <form action="" method="POST" class="card">
            <label>Username:</label>
            <input type="text" name="username" 
                        required
                        pattern="[A-Z][a-z]*"
                        title="Start with a capital letter, no spaces (e.g., John)"
                        value="<?= $user['username']; ?>" ><br>

            <label>Email:</label>
            <input type="email" name="email" value="<?php echo $user['email']; ?>" required><br>

            <label>New Password (leave blank to keep):</label>
            <input type="password" name="password" 
                        pattern="(?=.*[0-9])(?=.*[\W_]).{8,}" 
                        title="At least 8 characters, with a number and special character" ><br>

            <?php if($is_student):?>
            
            <label>Major:</label>
            <input type="text" name="major" value="<?=  $student['major']; ?>"><br>

            <label>Batch:</label>
            <input type="text" name="batch" value="<?=  $student['batch']; ?>"><br>
            
            <?php endif; ?>

            <?php if($is_instructor):?>
            
            <label>Designation:</label>
            <input type="text" name="designation" value="<?=  $instructor['designation']; ?>"><br>

            <label>Initial:</label>
            <input type="text" name="initial" value="<?=  $instructor['initial']; ?>"><br>

            <label>Department:</label>
            <input type="text" name="department" value="<?=  $instructor['department']; ?>"><br>
            
            <?php endif; ?>

            <button type="submit" class="button">Save Changes</button>
            <a href="profile.php" class="button">Back</a>
        </form>
    </div>
</body>
</html>


--- hide_status.php ---
Path: .\Profile_dashboard\hide_status.php

<?php
session_start();
require_once '../connect.php';

if (!isset($_SESSION['user_id'])) {
    header("Location: ../Login/loginpage.php");
    exit();
}

$user_id = $_SESSION['user_id'];
$status = isset($_POST['hide_status']) ? 'Hidden' : 'Online';

mysqli_query($conn, "UPDATE user SET status = '$status' WHERE user_id = $user_id");

header("Location: profile.php");
exit();
?>


--- profile.php ---
Path: .\Profile_dashboard\profile.php

<?php 
session_start();
require_once '../connect.php';

if (!isset($_SESSION['user_id'])) {
    header("Location: ../Login/loginpage.php");
    exit();
}

$user_id = $_SESSION['user_id'];


$user_sql = "SELECT * FROM user WHERE user_id = $user_id";
$user_result = mysqli_query($conn, $user_sql);
$user = mysqli_fetch_assoc($user_result);


$student_sql = "SELECT * FROM student WHERE user_id = $user_id";
$student_result = mysqli_query($conn, $student_sql);
$student = mysqli_fetch_assoc($student_result);


$instructor_sql = "SELECT * FROM instructor WHERE user_id = $user_id";
$instructor_result = mysqli_query($conn, $instructor_sql);
$instructor = mysqli_fetch_assoc($instructor_result);


$routine_sql = "
SELECT s.course_code, s.section, cs.day, cs.start_time, cs.end_time, cs.room
FROM enrollments e
JOIN sections s ON e.section_id = s.section_id
JOIN class_schedule cs ON s.section_id = cs.section_id
WHERE e.user_id = $user_id
ORDER BY s.course_code
";

$routine_result = mysqli_query($conn, $routine_sql);

if ($_SERVER['REQUEST_METHOD'] == 'POST' && isset($_POST['status'])) {
    $new_status = $_POST['status'];
    if ($new_status === 'Online' || $new_status === 'Hidden') {
        $update_status_sql = "UPDATE user SET status = '$new_status' WHERE user_id = $user_id";
        mysqli_query($conn, $update_status_sql);
        $_SESSION['status'] = $new_status;
        $user['status'] = $new_status;
    }
} else {
    if (isset($_SESSION['status'])) {
        $user['status'] = $_SESSION['status'];
    }
}
?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile Dashboard — BracuSync</title>
    <link rel="stylesheet" href="profile.css">
</head>
<body>
    <div class="bg-overlay"></div>
    <main>
        <nav>
            <a href="../index.php">Home</a>
            <a href="profile.php" class="active">Profile</a>
            <a href="../lost_and_found/lost_and_foundpage.php">Lost And Found</a>
            <a href="../Resource_Repository/resourcepage.php">Resource Repository</a>
            <a href="../logout.php">Logout</a>
        </nav>

        <div class="container">
            <h1>Your Profile Dashboard</h1>

            <div class="section card">
                <h2>User Info</h2>
                <p><strong>Username:</strong> <?= ($user['username']); ?></p>
                <p><strong>Email:</strong> <?= ($user['email']); ?></p>
                <p><strong>ID No:</strong> <?= ($user['id_no']); ?></p>

                <form method="POST" class="status-toggle">
                    <label for="status"><strong>Status:</strong></label>
                    <select name="status" id="status" onchange="this.form.submit()">
                        <option value="Online" <?php if ($user['status'] === 'Online') echo 'selected'; ?>>Online</option>
                        <option value="Hidden" <?php if ($user['status'] === 'Hidden') echo 'selected'; ?>>Hidden</option>
                    </select>
                </form>
            </div>

            <?php if ($student): ?>
                <div class="section card">
                    <h2>Student Info</h2>
                    <p><strong>Batch:</strong> <?= ($student['batch']); ?></p>
                    <p><strong>Major:</strong> <?= ($student['major']); ?></p>
                </div>
            <?php endif; ?>

            <?php if ($instructor): ?>
                <div class="section card">
                    <h2>Instructor Info</h2>
                    <p><strong>Department:</strong> <?= ($instructor['department']); ?></p>
                    <p><strong>Designation:</strong> <?= ($instructor['designation']); ?></p>
                    <p><strong>Initial:</strong> <?= ($instructor['initial']); ?></p>
                </div>
            <?php endif; ?>

            <div class="section card">
                <h2>Class Routine</h2>
                <?php if (mysqli_num_rows($routine_result) > 0): ?>
                    <table class="routine-table">
                        <thead>
                            <tr>
                                <th>Course Code</th>
                                <th>Section</th>
                                <th>Day</th>
                                <th>Start</th>
                                <th>End</th>
                                <th>Room</th>
                            </tr>
                        </thead>
                        <tbody>
                            <?php while ($row = mysqli_fetch_assoc($routine_result)): ?>
                                <tr>
                                    <td><?= ($row['course_code']); ?></td>
                                    <td><?= ($row['section']); ?></td>
                                    <td><?= ($row['day']); ?></td>
                                    <td><?= ($row['start_time']); ?></td>
                                    <td><?= ($row['end_time']); ?></td>
                                    <td><?= ($row['room']); ?></td>
                                </tr>
                            <?php endwhile; ?>
                        </tbody>
                    </table>
                <?php else: ?>
                    <p>No class routines found.</p>
                <?php endif; ?>
            </div>

            <div class="section card button-group">
                <a href="../group_post/group_select.php">Groups</a>
                <a href="../messaging/messages.php">Messages</a>
                <a href="../course_enrollment/select_courses.php">Edit Routine</a>
                <a href="edit_profile.php">Edit Profile</a>
                
            </div>
        </div>
    </main>

    <footer class="site-footer">
        © 2025 Brac University. All rights reserved.
    </footer>
</body>
</html>

--- register.php ---
Path: .\Registration\register.php

<?php
session_start();
require_once '../connect.php';

$username = trim($_POST['username']);
$email = trim($_POST['email']);
$hashedPassword = password_hash($_POST['password'], PASSWORD_DEFAULT);

$_SESSION['username'] = $username;
$_SESSION['email'] = $email;


$query = "SELECT * FROM user WHERE email = '$email'";
$result = mysqli_query($conn, $query);

if (mysqli_num_rows($result) > 0) {
    $_SESSION["reg_error"] = "Email already registered!";
    header("Location: registerpage.php");
    exit();
} else {
    $sql = "INSERT INTO user (username, email, password) VALUES ('$username', '$email', '$hashedPassword')";
    mysqli_query($conn, $sql); 
    header("Location: ../Login/loginpage.php"); 
    exit();
} 
?>

--- registerpage.php ---
Path: .\Registration\registerpage.php

<?php session_start(); ?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login and Registration Form</title>
    <link rel="stylesheet" href="style.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
</head>
<body>
    <div class="video-background">
        <iframe 
            src="https://www.youtube.com/embed/tthY4pJqfEw?autoplay=1&mute=1&controls=0&showinfo=0&modestbranding=1&rel=0&loop=1&playlist=tthY4pJqfEw&playsinline=1" 
            frameborder="0" 
            allow="autoplay; fullscreen" 
            allowfullscreen>
        </iframe>
    </div> 

    <div class="video-overlay"></div>
    <div class="wrapper">
        <span class="bg"></span>

        <div class="form-box register">
            <h2>Sign Up</h2>
            <form action="register.php" method="POST">
                <div class="input-box">
                    <input type="text" name="username" required
                        pattern="[A-Z][a-z]*"
                        title="Start with a capital letter, no spaces (e.g., John)"
                        value="<?= isset($_SESSION['username']) ? ($_SESSION['username']) : ''; ?>" placeholder=" ">
                    <label>Username</label>
                    <i class='bx bxs-user'></i>
                </div>

                <div class="input-box">
                    <input type="email" name="email" required 
                        value="<?= isset($_SESSION['email']) ? ($_SESSION['email']) : ''; ?>" placeholder=" ">
                    <label>Email</label>
                    <i class='bx bxs-envelope'></i>
                </div>

                <div class="input-box">
                    <input type="password" name="password" required
                        pattern="(?=.*[0-9])(?=.*[\W_]).{8,}" 
                        title="At least 8 characters, with a number and special character"
                        value="<?= isset($_SESSION['password']) ? ($_SESSION['password']) : ''; ?>" placeholder=" ">
                    <label>Password</label>
                    <i class='bx bxs-lock-alt'></i>
                </div>

                <button type="submit" class="btn">Sign Up</button>

                <div class="logreg-link">
                    <p>Already have an account? <a href="../Login/loginpage.php" class="login-link">Login</a></p>
                </div>

                <?php if (isset($_SESSION["reg_error"])): ?>
                    <p style="font-size: 15px; color: red; text-align: center;"><?= $_SESSION["reg_error"]; ?></p>
                <?php endif; ?>
            </form>
        </div>

        <div class="info-text register">
            <h2>Welcome to <p>bracusync</p></h2>
            <p>Sign up now to access all the features.</p>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>


--- resourcepage.php ---
Path: .\Resource_Repository\resourcepage.php

<?php
session_start();
require_once '../connect.php';

if (!isset($_SESSION['user_id'])) {
    header("Location: ../Login/loginpage.php");
    exit();
}
?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>University Resource Repository — BracuSync</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="bg-overlay"></div>
    <main>
        <nav>
            <a href="../index.php">Home</a>
            <a href="../Profile_dashboard/profile.php">Profile</a>
            <a href="../lost_and_found/lost_and_foundpage.php">Lost And Found</a>
            <a href="resourcepage.php" class="active">Resource Repository</a>
            <a href="../logout.php">Logout</a>
        </nav>

        <div class="container upload-section">
            <h1>Upload New Resource</h1>
            <div class="section card">
                <form action="resource_submit.php" method="POST" class="report-form">
                    <label for="resource_name">Resource Name</label>
                    <input type="text" id="resource_name" name="resource_name" required>

                    <label for="course_name">Course Name</label>
                    <input type="text" id="course_name" name="course_name"  required>

                    <label for="description">Description</label>
                    <textarea id="description" rows="5" name="description"  required></textarea>

                    <label for="resource_link">Resource Link</label>
                    <input type="text" id="resource_link" name="resource_link" required>

                    <button type="submit" class="btn">Upload Resource</button>
                </form>
            </div>
        </div>

        <div class="container resources-section">
            <h1>Resources</h1>
            <div class="section card search-section">
                
                <form method="GET" class="report-form">
                    
                    <input type="text" id="search" name="search" placeholder="Search by Course Name or Resource Name" value="<?= isset($_GET['search']) ? htmlspecialchars($_GET['search']) : ''; ?>">
                    <button type="submit" class="btn">Search</button>
                </form>
            </div>

            <div class="section card items-section">
                <h2>Available Resources</h2>
                <table class="routine-table">
                    <thead>
                        <tr>
                            <th>Resource Name</th>
                            <th>Course Name</th>
                            <th>Uploaded By</th>
                            <th>Date</th>
                            <th>Links</th>
                        </tr>
                    </thead>
                    <tbody>
                        <?php
                        $search = isset($_GET['search']) ? trim($_GET['search']) : '';

                        $sql = "SELECT resources.*, user.username 
                                FROM resources 
                                JOIN user ON resources.user_id = user.user_id";

                        if (!empty($search)) {
                            $sql .= " WHERE LOWER(resources.course_name) LIKE LOWER('%$search%') 
                                    OR LOWER(resources.resource_name) LIKE LOWER('%$search%')";
                        }

                        $sql .= " ORDER BY resources.date DESC";
                        
                        $result = mysqli_query($conn, $sql);

                        if (mysqli_num_rows($result) > 0) {
                            while ($row = mysqli_fetch_array($result)) {
                                echo "<tr>
                                    <td>" . htmlspecialchars($row['resource_name']) . "</td>
                                    <td>" . htmlspecialchars($row['course_name']) . "</td>
                                    <td>" . htmlspecialchars($row['username']) . "</td> 
                                    <td>" . htmlspecialchars($row['date']) . "</td>
                                    <td><a href='" . htmlspecialchars($row['resource_link']) . "' target='_blank'>Link</a></td>
                                </tr>";
                            }
                        } else {
                            echo "<tr><td colspan='5'>No resources uploaded yet.</td></tr>";
                        }

                        mysqli_close($conn);
                        ?>
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <footer class="site-footer">
        © 2025 Brac University. All rights reserved.
    </footer>
</body>
</html>

--- resource_submit.php ---
Path: .\Resource_Repository\resource_submit.php


<?php
session_start();
require_once '../connect.php';


$resourceName = $_POST['resource_name'];
$courseName = $_POST['course_name'];
$description = $_POST['description'];
$resourceLink = $_POST['resource_link'];
$uploadedBy = $_SESSION['username']; 
$date = date('Y-m-d H:i:s');
$user_id = $_SESSION['user_id'];


$sql = "INSERT INTO resources (course_name, resource_name, description, resource_link, date, user_id )
        VALUES ('$courseName', '$resourceName', '$description', '$resourceLink', '$date', '$user_id')";

mysqli_query($conn, $sql);
header("Location: resourcepage.php"); 


mysqli_close($conn);
?>


--- instructor_info.php ---
Path: .\welcome__role_select\instructor_info.php

<?php
session_start();
require_once '../connect.php';

if (!isset($_SESSION['user_id'])) {
    header("Location: /BracuSync/Login/loginpage.php");
    exit();
}
$error_message = null;
$user_id = $_SESSION['user_id'];

if ($_SERVER['REQUEST_METHOD'] == 'POST'){

$department = $_POST['department'];
$designation = $_POST['designation'];
$id_no = $_POST['id_no'];
$initial = $_POST['initial'];

$checkIdNo = "SELECT * FROM user WHERE id_no = '$id_no'";
$result = mysqli_query($conn, $checkIdNo);
if (mysqli_num_rows($result) > 0) {
    $error_message = "This Employee ID already exists. Please enter a different ID.";}
else{
    $insertInstructor = "INSERT INTO instructor (user_id, department, designation, initial) 
                            VALUES ($user_id, '$department', '$designation', '$initial')";
    mysqli_query($conn, $insertInstructor);


    $updateUser = "UPDATE user SET id_no = '$id_no' WHERE user_id = $user_id";
    mysqli_query($conn, $updateUser);

    header("Location: /BracuSync/index.php");
    exit();
}

}
?>


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Instructor Info</title>
    <link rel="stylesheet" href="welcome.css">
</head>
<body>
    <div class="bg-overlay"></div>
    <div class="container fade-in">
        
        <?php if ($error_message): ?>
            <div class="error-message"><?php echo htmlspecialchars($error_message); ?></div>
        <?php endif; ?>

        <h1>Enter Your Instructor Info</h1>
        <form method="POST" class="info-form">
            <label for="department">Department</label>
            <input type="text" name="department" id="department" placeholder="e.g., CSE" required>

            <label for="designation">Designation</label>
            <input type="text" name="designation" id="designation" placeholder="e.g., Lecturer" required>

            <label for="initial">Initial</label>
            <input type="text" name="initial" id="initial" placeholder="e.g., ZKH" required>

            <label for="id_no">Employee ID</label>
            <input type="text" name="id_no" id="id_no" placeholder="Employee ID" required>

            <button type="submit" class="btn">Submit</button>
        </form>
    </div>
</body>
</html>

--- process_role.php ---
Path: .\welcome__role_select\process_role.php

<?php
session_start();

if (!isset($_SESSION['user_id']) || !isset($_POST['role'])) {
    header("Location: role_select.php");
    exit();
}

$role = $_POST['role'];

if ($role === 'student') {
    header("Location: student_info.php");
} elseif ($role === 'instructor') {
    header("Location: instructor_info.php");
} else {
    header("Location: role_select.php");
}
exit();


--- role_select.php ---
Path: .\welcome__role_select\role_select.php

<?php
session_start();
if (!isset($_SESSION['user_id'])) {
    header("Location: /BracuSync/Login/loginpage.php");
    exit();
}
?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Select Role</title>
    <link rel="stylesheet" href="welcome.css">
</head>
<body>
    <div class="bg-overlay"></div>
    <div class="container fade-in">
        <h1>Select Your Role</h1>
        <form method="POST" action="process_role.php" class="role-form">
            <button type="submit" name="role" value="student" class="role-button btn">Student</button>
            <button type="submit" name="role" value="instructor" class="role-button btn">Instructor</button>
        </form>
    </div>
</body>
</html>

--- student_info.php ---
Path: .\welcome__role_select\student_info.php

<?php
session_start();
require_once '../connect.php';

if (!isset($_SESSION['user_id'])) {
    header("Location: /BracuSync/Login/loginpage.php");
    exit();
}

$user_id = $_SESSION['user_id'];
$error_message = ''; 


$session = $_POST['session']; 
$year = $_POST['year']; 
$batch = $session . '-' . $year;
$major = $_POST['major'];
$id_no = $_POST['id_no'];


$checkIdNo = "SELECT * FROM user WHERE id_no = '$id_no'";
$result = mysqli_query($conn, $checkIdNo);

if (mysqli_num_rows($result) > 0) {

    $error_message = "This Student ID already exists. Please enter a different ID.";
} else {

    $insertStudent = "INSERT INTO student (user_id, batch, major) VALUES ($user_id, '$batch', '$major')";
    mysqli_query($conn, $insertStudent);


    $updateUser = "UPDATE user SET id_no = '$id_no' WHERE user_id = $user_id";
    mysqli_query($conn, $updateUser);

    header("Location: /BracuSync/index.php");
    exit();
}

?>


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Student Info</title>
    <link rel="stylesheet" href="welcome.css">
</head>
<body>
    <div class="bg-overlay"></div>
    <div class="container fade-in">
        <h1>Enter Your Student Info</h1>

        
        <?php if ($error_message): ?>
            <div class="error-message"><?php echo htmlspecialchars($error_message); ?></div>
        <?php endif; ?>

        <form method="POST" class="info-form">
            <label for="session">Select Admission Session</label>
            <select name="session" id="session" required>
                <option value="Spring">Spring</option>
                <option value="Summer">Summer</option>
                <option value="Fall">Fall</option>
            </select>

            <label for="year">Admission Year</label>
            <input type="text" name="year" id="year" placeholder="e.g., 2022" required>

            <label for="major">Major</label>
            <input type="text" name="major" id="major" placeholder="e.g., CSE" required>

            <label for="id_no">Student ID</label>
            <input type="text" name="id_no" id="id_no" placeholder="Student ID" required>

            <button type="submit" class="btn">Submit</button>
        </form>
    </div>
</body>
</html>

--- welcome.php ---
Path: .\welcome__role_select\welcome.php

<?php
session_start();
require_once '../connect.php';

if (!isset($_SESSION['user_id'])) {
    header("Location: /BracuSync/Login/loginpage.php");
    exit();
}

$user_id = $_SESSION['user_id'];
$query = "SELECT id_no FROM user WHERE user_id = $user_id";
$result = mysqli_query($conn, $query);
$user = mysqli_fetch_assoc($result);


if (!empty($user['id_no'])) {
    header("Location: /BracuSync/index.php");
    exit();
}
?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Welcome to BracuSync</title>
    <link rel="stylesheet" href="welcome.css">
</head>
<body>
    <div class="bg-overlay"></div>
    <div class="container fade-in">
        <h1>Welcome to <span style="color: #007bff;">BracuSync</span></h1>
        <p class="info-text">
            BracuSync is your all-in-one academic assistant designed for the BRAC University community.
            Whether you're a student or an instructor, BracuSync helps you stay connected, informed, and organized.
            <br><br>
            📚 <strong>Students</strong> can view their batch and major info, stay up to date with announcements, manage academic activities, and connect with instructors.
            <br><br>
            🎓 <strong>Instructors</strong> can manage course details, post updates, and communicate with students easily.
            <br><br>
            ✅ Secure login, personalized profiles, and a clean interface make BracuSync a powerful but simple tool for everyone at BRACU.
            <br><br>
            Click <strong>Next</strong> to select your role and complete your profile setup.
        </p>
        <a href="role_select.php" class="next-button btn">Next</a>
    </div>
</body>
</html>

